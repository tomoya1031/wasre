
<%= form_with model:@user, local:true do |f| %>

  <!-- エラーメッセージ表示-->
  <% if @user.errors.any? %>
	<div>
	  <h3><%= @user.errors.count %>error prohibited this obj from being saved:</h3>
		<ul>
		  <% @user.errors.full_messages.each do |message| %>
			<li><%= message %></li>
		  <% end %>
		</ul>
	</div>
  <% end %>
  <!-- フォーム部分 -->
  <div class="row">
    <div class="col-xs-1">
    </div>
    <div class="col-xs-7">
      <br>
      <h3><i class="fas fa-edit"></i>マイページ編集</h3><br>
    <div>
    <table class="table table-striped">
	  <tr>
		<th>プロフィール画像</th>
		<td>
		  <div class="item-image">
	      	<%= attachment_image_tag @user, :profile_image, class:"img-square", fallback: "no_image.jpg", size:"200x160" %>
	      	<%= f.attachment_field :profile_image %>
         </div>
		</td>
	  </tr>

      <tr>
		<th>名前</th>
		<td>
		  <%= f.text_field :name, :size=>"26" %>
		</td>
	  </tr>

      <tr>
		<th>自己紹介</th>
		<td>
		  <%= f.text_area :introduction, placeholder: "自己紹介", :size=>"26" %>
		</td>
	  </tr>

	  <tr>
		<th>メールアドレス</th>
		<td><%= f.text_field :email, :size=>"54" %></td>
	  </tr>

	  <tr>
		<th><%= f.label :post_code（ハイフンなし） %></th>
		<td><%= f.text_field :post_code , :size=>"26"%></td>
	  </tr>
      <tr>
        <th><%= f.label :prefecture_code %></th>
        <td><%= f.collection_select :prefecture_name, JpPrefecture::Prefecture.all,  :name, :name, autocomplete: "prefecture_code", id: "customer_prefecture_code" %></td>
      </tr>

	  <tr>
		<th><%= f.label :address_city %></th>
		<td><%= f.text_field :address_city, :size=>"54"%></td>
	  </tr>

      <tr>
		<th><%= f.label :address_street %></th>
		<td><%= f.text_field :address_street, :size=>"54"%></td>
	  </tr>

	  <tr>
		<th>電話番号（ハイフンなし）</th>
		<td><%= f.text_field :phone_number , :size=>"26"%></td>
	  </tr>
    </table>
  </div>
  <div>
	<%= f.submit "編集内容を保存する",class:"btn btn-primary" %>
  </div><br>
<% end %>



</div>
</div>
<script>
    $(function(){
    // inputのidから情報の取得
    $(".item-image").on('change', function (e) {
    // ここから既存の画像のurlの取得
    var reader = new FileReader();
    reader.onload = function (e) {
        $(".profile_image").attr('src', e.target.result);
    }
    // ここまで
    reader.readAsDataURL(e.target.files[0]);
    //取得したurlにアップロード画像のurlを挿入
});
});
</script>